import cv2
import numpy as np
from PIL import ImageGrab


def screenRec():
    # Defining the codec
    fourcc = cv2.VideoWriter_fourcc(*'XVID')
    # Defined frame rate of the output video stream
    fps = 8.0

    # output video cv2.VideoWriter( filename, fourcc, fps, frameSize(width,height) )
    out = cv2.VideoWriter('output.avi', fourcc, fps, (1366, 768))

    while(True):

        # Take a snapshot of the screen using imagegrab
        img = ImageGrab.grab()

        # convert this image to numpy array
        img_np = np.array(img)

        # reads colors as BGR
        # frame is converted to HSV (HSL and HSV are alternative representations of the RGB color model, designed in the 1970s by computer graphics researchers to more closely align with the way human vision perceives color-making attributes.)
        frame = cv2.cvtColor(img_np, cv2.COLOR_BGR2RGB)

        # display this frame as a video with title
        win_title = "Screen Recorder"
        cv2.imshow(win_title, frame)

        # output the frame
        out.write(frame)

        # Wait for 'q' key to stop the program
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    # Close the window and Release recording
    out.release()

    # De-allocate any associated memory usage
    cv2.destroyAllWindows()


# call screenRec function
screenRec()
